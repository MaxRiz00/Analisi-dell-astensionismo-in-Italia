tab=read.table('tabella_nuova',header=T)
helpView(tab)
dim(tab)
summary(tab)
print(sapply(tab, typeof))
P=c("X1","X2","X3","X4","X5","X6","X7","X8")
dev.new()
m <- mapply(tab[P], FUN=as.numeric)
barplot(colMeans(m),names.arg=c("PD","Lega",
"M5S","ForzaItalia","FratelliItalia",
"+europa","europaverde","lasinistra"),col = 'red')
#esempio di correlazione
pairs(tab[ , c('stranieri','denunce_su_abitante')], pch = 16)
pairs(tab[ , c('aste','FasciaEta2','FasciaEta3','FasciaEta4')], pch = 16)
attach(tab)
g = lm( aste ~ disoccup  + uni + FasciaEta2 + FasciaEta3+ FasciaEta4 + FasciaEta5, data = tab)
summary( g )
library(car)
#calculate the VIF for each predictor variable in the model
vif(g)
g = lm( aste ~ disoccup  + uni  + FasciaEta4 + FasciaEta5, data = tab)
summary( g )
plot( ellipse( g, c( 3, 4 ) ), type = "l", xlim = c( -10, 2 ) ,ylim=c(-1,1))
points( 0, 0 )
points( g$coef[ 3 ] , g$coef[ 4 ] , pch = 18 )
plot( g$fit, g$res, xlab = "Fitted", ylab = "Residuals",
main = "Residuals vs Fitted Values", pch = 16 )
abline( h = 0, lwd = 2, lty = 2, col = 'red' )
qqnorm( g$res, ylab = "Raw Residuals", pch = 16 )
qqline( g$res ,col='red')
shapiro.test( g$res )
bc=boxcox(aste ~ disoccup + uni + FasciaEta4 + FasciaEta5, data = tab,lambda=c(-2,2))
lambda <- bc$x[which.max(bc$y)]
g1 <- lm(((aste^lambda-1)/lambda) ~ disoccup + uni + redditobasso + stranieri , data = tab)
par(mfrow=c(2,2))
plot(g1)
plot( g1$fit, g1$res, xlab = "Fitted", ylab = "Residuals",
main = "Residuals vs Fitted Values", pch = 16 )
abline( h = 0, lwd = 2, lty = 2, col = 'red' )
par(mfrow=c(1,1))
qqnorm( g1$res, ylab = "Raw Residuals", pch = 16 )
